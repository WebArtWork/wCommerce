import{a as L}from"./chunk-AWM4IRWC.js";import{a as $}from"./chunk-GKEHRPNS.js";import{a as Q}from"./chunk-4DHECZNB.js";import{e as R}from"./chunk-IJ4Z7FZT.js";import{$ as c,Db as P,Fa as a,Ga as I,I as O,Mb as V,P as C,Pb as D,Q as S,Z as k,_b as N,ab as E,da as m,f as g,fa as x,ga as M,ja as b,la as u,na as h,ob as T,pa as r,pb as q,qa as o,ra as v,sb as F,tb as w,ua as y,va as p,wa as _,zb as j}from"./chunk-YSNUVGWI.js";function H(n,f){if(n&1){let t=y();r(0,"div"),v(1,"wselect",26),r(2,"winput",27),p("wChange",function(e){let s=C(t).$implicit,l=_(2);return l.orderingQuantity[s._id]=e?+e:0,S(l.update())}),o()()}if(n&2){let t=f.$implicit,i=_().$implicit,e=_();c(),u("items",i.options)("select",t._id),c(),u("value",e.orderingQuantity[t._id])}}function A(n,f){if(n&1){let t=y();r(0,"div",23)(1,"div",24),a(2),o(),b(3,H,3,3,"div",25),r(4,"a",19),p("click",function(){let e=C(t).$implicit,s=_();return S(s.remove(e))}),a(5,"Common.Remove from cart"),o()()}if(n&2){let t=f.$implicit,i=_();c(2),I(t.name),c(),u("ngForOf",i.orderingOptions[t._id])}}var U=(()=>{class n{constructor(t,i,e,s,l,z){this._orderService=t,this._cartService=i,this.userService=e,this._core=s,this._http=l,this._router=z,this.isMenuOpen=!1,this.products=this._cartService.products,this.orderingOptions=this._cartService.orderingOptions,this.orderingQuantity=this._cartService.orderingQuantity;for(let d of this.products)this.orderingOptions[d._id]?.length||(this.orderingOptions[d._id]=this.orderingOptions[d._id]||[],d.options?.length&&(this.orderingOptions[d._id].push(d.options[0]),this.orderingQuantity[d.options[0]._id]=1,this.update()));this.load()}update(){this._cartService.update()}remove(t){this.products=this.products.filter(i=>i._id!==t._id),this._cartService.remove(t)}load(){return g(this,null,function*(){let t=this._http.get("/api/commerce/products"+this._query());t.subscribe(i=>{this.products=i.map(e=>(e.quantity=e.options?.map(s=>s.quantity||0).reduce((s,l)=>s+l,0),e)),this._cartService.products=this.products}),yield t.toPromise()})}back(){window.history.back()}order(){return g(this,null,function*(){yield this.load(),this._orderService.create({deviceID:this._core.deviceID,products:this._orderProducts()}).subscribe(()=>{this._cartService.clear(),this._router.navigateByUrl("/orders")})})}_query(){return"?_ids="+this._cartService.products.map(t=>t._id).toString()+(w.commerceId?"&commerce="+w.commerceId:"")}_orderProducts(){let t=[];for(let i of this.products)for(let e of this.orderingOptions[i._id])t.push({quantity:this.orderingQuantity[e._id]||1,product:i._id,option:e._id});return t}static{this.\u0275fac=function(i){return new(i||n)(m($),m(L),m(Q),m(j),m(P),m(T))}}static{this.\u0275cmp=x({type:n,selectors:[["ng-component"]],standalone:!1,decls:30,vars:8,consts:[[1,"documents-wrapper"],[1,"documents-container"],[1,"documents-list"],[1,"documents-header"],[1,"documents-header-left"],[1,"documents-header-left__arrow",3,"click"],[1,"material-icons"],["routerLink","/profile",1,"documents-header-left__avatar"],["alt","",3,"src"],[1,"documents-header__title"],[1,"burger-wrap",3,"click"],[1,"burger"],[1,"documents-sidebar"],[1,"documents-sidebar__close",3,"click"],[1,"documents-sidebar-content"],[1,"documents-sidebar__img"],["src","assets/default.png","alt",""],[1,"documents-sidebar__title"],[1,"documents-sidebar__description"],["translate","",1,"documents__btn",3,"click"],[1,"documents-main"],[1,"documents-main-content"],["class","documents-main-row",4,"ngFor","ngForOf"],[1,"documents-main-row"],[1,"documents__title"],[4,"ngFor","ngForOf"],[3,"items","select"],["type","number",3,"wChange","value"]],template:function(i,e){i&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),p("click",function(){return e.back()}),r(6,"span",6),a(7,"arrow_back_ios"),o()(),r(8,"div",7),v(9,"img",8),o()(),r(10,"div",9),a(11,"Title header"),o(),r(12,"div",10),p("click",function(){return e.isMenuOpen=!e.isMenuOpen}),v(13,"div",11),o()(),r(14,"div",12)(15,"div",13),p("click",function(){return e.isMenuOpen=!e.isMenuOpen}),r(16,"span",6),a(17,"close"),o()(),r(18,"div",14)(19,"div",15),v(20,"img",16),o(),r(21,"div",17),a(22," Title of sidebar... "),o(),r(23,"div",18),a(24," Lorem ipsum dolor sit amet consectetur adipisicing elit. Sint molestiae consequatur quae. Modi corporis rem amet tempore debitis assumenda minima repellat labore expedita quam. Itaque accusamus culpa ullam necessitatibus nisi. "),o(),r(25,"a",19),p("click",function(){return e.order()}),a(26,"Common.Order"),o()()(),r(27,"div",20)(28,"div",21),b(29,A,6,2,"div",22),o()()()()()),i&2&&(h("documents-wrapper--open",e.isMenuOpen),c(9),u("src",e.userService.thumb,k),c(4),h("burger--close",e.isMenuOpen),c(),h("documents-sidebar--open",e.isMenuOpen),c(15),u("ngForOf",e.products))},dependencies:[q,V,N,E,D],encapsulation:2})}}return n})();var G=[{path:"",component:U}],de=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=M({type:n})}static{this.\u0275inj=O({imports:[F.forChild(G),R]})}}return n})();export{de as CartModule};
