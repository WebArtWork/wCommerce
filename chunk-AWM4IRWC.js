import{Cb as d,H as n,K as r,f as o,zb as c}from"./chunk-YSNUVGWI.js";var u=(()=>{class s{constructor(t,i){this._storeService=t,this._core=i,this.orderingOptions={},this.orderingQuantity={},this._storeService.getJson("cart_products",e=>this.products=e||this.products||[]),this._storeService.getJson("cart_options",e=>this._core.copy(e||{},this.orderingOptions)),this._storeService.getJson("cart_quantity",e=>this._core.copy(e||{},this.orderingQuantity))}clear(){this.products=[],this.orderingOptions={},this.orderingQuantity={},this._storeService.remove("cart_products"),this._storeService.remove("cart_options"),this._storeService.remove("cart_quantity")}update(){this._storeService.setJson("cart_options",this.orderingOptions),this._storeService.setJson("cart_quantity",this.orderingQuantity)}add(t){this.isAdded(t).then(i=>{i||(this.products.push(t),this._update())})}remove(t){this.isAdded(t).then(i=>{i&&(this.products.splice(this.products.findIndex(e=>e._id===t._id),1),this._update())})}toggle(t){this.isAdded(t).then(i=>{i?this.remove(t):this.add(t)})}isAdded(t){return o(this,null,function*(){return new Promise(i=>{let e=()=>{this.products?i(!!this.products.find(h=>h._id===t._id)):setTimeout(e.bind(this),100)};e()})})}_update(){this._storeService.setJson("cart_products",this.products)}wait(t){return new Promise(i=>setTimeout(i,t))}static{this.\u0275fac=function(i){return new(i||s)(r(d),r(c))}}static{this.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{u as a};
