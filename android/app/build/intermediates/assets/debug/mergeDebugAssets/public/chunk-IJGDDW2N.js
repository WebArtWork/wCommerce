import{a as j}from"./chunk-HZVGXVXD.js";import{e as T}from"./chunk-QJDHHX4S.js";import{Bb as I,L as c,M as h,N as p,S as f,Ta as g,Va as u,Y as d,Za as _,_a as v,fb as C,kb as b,mb as S,s as l,sb as y,zb as k}from"./chunk-CNPABYXW.js";var M={formId:"commercetag",title:"Commercetag",components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill commercetag title"},{name:"Label",value:"Title"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill commercetag description"},{name:"Label",value:"Description"}]},{name:"Photo",key:"thumb",fields:[{name:"Label",value:"Header picture"}]}]};var a=(()=>{class r{childrenUrl(e){let i=this._router.url.split("/");return this.parent&&i.pop(),i.push(e._id),i.join("/")}setTags(){this.tags.splice(0,this.tags.length);for(let e of this._commercetagService.commercetags)!this.commerce&&!this.parent?e.parent||this.tags.push(e):this.commerce&&this.parent?e.parent===this.parent&&e.commerce===this.commerce&&this.tags.push(e):this.parent?e.parent===this.parent&&this.tags.push(e):e.commerce===this.commerce&&!e.parent&&this.tags.push(e)}update(e){this._commercetagService.update(e)}constructor(e,i,t,m,n,w,x,F){this._translate=e,this._commercetagService=i,this.route=t,this._alert=m,this._form=n,this._mongo=w,this._core=x,this._router=F,this.commerce="",this.parent="",this.columns=["name"],this.form=this._form.getForm("commercetag",M),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(o,s)=>{this.commerce&&(o.commerce=this.commerce),this.parent&&(o.parent=this.parent),this._commercetagService.create(o,{callback:()=>{this.setTags()}}),s()}})},update:o=>{this._form.modal(this.form,[],o).then(s=>{this._core.copy(s,o),this._commercetagService.update(o,{callback:()=>{this.setTags()}})})},delete:o=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this commercetag?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._commercetagService.delete(o,{callback:()=>{this.setTags()}})}}]})},buttons:[{icon:"label_important",hrefFunc:this.childrenUrl.bind(this)},{icon:"arrow_upward",click:o=>{let s=this.tags.findIndex(N=>N._id===o._id);[this.tags[s],this.tags[s-1]]=[this.tags[s-1],this.tags[s]]}},{icon:"cloud_download",click:o=>{this._form.modalUnique("commercetag","url",o)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.tags=JSON.parse(JSON.stringify(this._commercetagService.commercetags)),this._mongo.on("commercetag",this.setTags.bind(this))}ngOnInit(){this.route.params.subscribe(e=>{e.parent&&(this.parent=e.parent),e.commerce_id&&(this.commerce=e.commerce_id),this.commerce=this.commerce||v.commerceId}),this.setTags()}_bulkManagement(e=!0){return()=>{this._form.modalDocs(e?[]:this.tags).then(i=>{if(e)for(let t of i)this.commerce&&(t.commerce=this.commerce),this._commercetagService.create(t);else{for(let t of this.tags)i.find(m=>m._id===t._id)||this._commercetagService.delete(t);for(let t of i){let m=this.tags.find(n=>n._id===t._id);m?(this._core.copy(t,m),this._commercetagService.update(m)):(this.commerce&&(t.commerce=this.commerce),t.__created=!1,this._commercetagService.create(t))}}})}}static{this.\u0275fac=function(i){return new(i||r)(c(y),c(j),c(g),c(b),c(I),c(S),c(C),c(u))}}static{this.\u0275cmp=h({type:r,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Commercetags",3,"columns","config","rows"]],template:function(i,t){i&1&&d(0,"wtable",0),i&2&&f("columns",t.columns)("config",t.config)("rows",t.tags)},dependencies:[k],encapsulation:2})}}return r})();var A=[{path:"",component:a},{path:":commerce_id/:parent",component:a},{path:":commerce_id",component:a}],K=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=p({type:r})}static{this.\u0275inj=l({imports:[_.forChild(A),T]})}}return r})();export{K as CommercetagsModule};
