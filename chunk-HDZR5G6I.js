import{a as et}from"./chunk-3RKYZXIE.js";import{a as tt}from"./chunk-TTRQQEBV.js";import{a as P,b as E,c as Ye,d as y}from"./chunk-2G5BSJPQ.js";import{e as Je}from"./chunk-IJ4Z7FZT.js";import{$ as _,A as ue,B as $,C as fe,Ca as Fe,D as I,Da as Me,Db as Ze,E as pe,Ea as Ae,Fa as T,G as _e,Ga as Le,H as m,Ha as Ie,I as g,J as v,Ja as ze,K as me,Ka as Be,L as a,La as Pe,M as ge,Ma as k,N as ve,Nb as Xe,O as Ce,P as H,Pb as Ke,Q as q,S as we,T as Se,Ta as Ne,U as b,Ua as je,V as x,Wa as Ue,Y as Ee,Ya as B,aa as ye,ba as G,bb as We,ca as De,d as gt,da as O,e as vt,ea as Re,fa as z,g as ne,ga as C,ha as w,i as W,ia as Q,j as oe,ja as Z,k as u,la as Y,m as se,ma as be,mb as $e,n as le,na as xe,o as R,p as A,pa as f,qa as p,r as ae,ra as Oe,sb as He,tb as qe,u as ce,ua as Te,v as L,va as S,w as de,wa as X,wb as Ge,xa as ke,xb as Qe,y as he,ya as Ve}from"./chunk-YSNUVGWI.js";var it=gt(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var h=function(){function i(){}return i.EOL=`\r
`,i.BOM="\uFEFF",i.DEFAULT_FIELD_SEPARATOR=",",i.DEFAULT_DECIMAL_SEPARATOR=".",i.DEFAULT_QUOTE='"',i.DEFAULT_SHOW_TITLE=!1,i.DEFAULT_TITLE="My Report",i.DEFAULT_FILENAME="mycsv.csv",i.DEFAULT_SHOW_LABELS=!1,i.DEFAULT_USE_BOM=!0,i.DEFAULT_HEADER=[],i.DEFAULT_NO_DOWNLOAD=!1,i.DEFAULT_REMOVE_EMPTY_VALUES=!1,i}();D.CsvConfigConsts=h;D.ConfigDefaults={filename:h.DEFAULT_FILENAME,fieldSeparator:h.DEFAULT_FIELD_SEPARATOR,quoteStrings:h.DEFAULT_QUOTE,decimalseparator:h.DEFAULT_DECIMAL_SEPARATOR,showLabels:h.DEFAULT_SHOW_LABELS,showTitle:h.DEFAULT_SHOW_TITLE,title:h.DEFAULT_TITLE,useBom:h.DEFAULT_USE_BOM,headers:h.DEFAULT_HEADER,noDownload:h.DEFAULT_NO_DOWNLOAD,removeEmptyValues:h.DEFAULT_REMOVE_EMPTY_VALUES};var Ct=function(){function i(o,e,t){this.csv="";var r=t||{};this.data=typeof o!="object"?JSON.parse(o):o,this._options=yt({},D.ConfigDefaults,r),this._options.filename&&(this._options.filename=e),this.generateCsv()}return i.prototype.generateCsv=function(){if(this._options.useBom&&(this.csv+=h.BOM),this._options.showTitle&&(this.csv+=this._options.title+`\r

`),this.getHeaders(),this.getBody(),this.csv==""){console.log("Invalid data");return}if(this._options.noDownload)return this.csv;var o=new Blob([this.csv],{type:"text/csv;charset=utf8;"});if(navigator.msSaveBlob){var e=this._options.filename.replace(/ /g,"_")+".csv";navigator.msSaveBlob(o,e)}else{var t="data:attachment/csv;charset=utf-8,"+encodeURI(this.csv),r=document.createElement("a");r.href=URL.createObjectURL(o),r.setAttribute("visibility","hidden"),r.download=this._options.filename.replace(/ /g,"_")+".csv",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},i.prototype.getHeaders=function(){var o=this;if(this._options.headers.length>0){var e=this._options.headers,t=e.reduce(function(r,n){return r+n+o._options.fieldSeparator},"");t=t.slice(0,-1),this.csv+=t+h.EOL}},i.prototype.getBody=function(){for(var o=0;o<this.data.length;o++){var e="";for(var t in this.data[o])e+=this.formartData(this.data[o][t])+this._options.fieldSeparator;e=e.slice(0,-1),this.csv+=e+h.EOL}},i.prototype.formartData=function(o){return this._options.removeEmptyValues&&!o?"":this._options.decimalseparator==="locale"&&i.isFloat(o)?o.toLocaleString():this._options.decimalseparator!=="."&&i.isFloat(o)?o.toString().replace(".",this._options.decimalseparator):typeof o=="string"?(o=o.replace(/"/g,'""'),(this._options.quoteStrings||o.indexOf(",")>-1||o.indexOf(`
`)>-1||o.indexOf("\r")>-1)&&(o=this._options.quoteStrings+o+this._options.quoteStrings),o):typeof o=="boolean"?o?"TRUE":"FALSE":o},i.prototype.getCsv=function(){return this.csv},i.isFloat=function(o){return+o===o&&(!isFinite(o)||!!(o%1))},i}();D.ngxCsv=Ct;var wt=Object.prototype.hasOwnProperty,St=Object.prototype.propertyIsEnumerable;function Et(i){if(i==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(i)}function yt(i){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];for(var t,r=Et(i),n,s=1;s<arguments.length;s++){t=Object(arguments[s]);for(var c in t)wt.call(t,c)&&(r[c]=t[c]);if(Object.getOwnPropertySymbols){n=Object.getOwnPropertySymbols(t);for(var l=0;l<n.length;l++)St.call(t,n[l])&&(r[n[l]]=t[n[l]])}}return r}});var _t=vt(it());var rt=(()=>{class i{constructor(e){this._http=e}getOptions(e,t,r,n){return this._http.get(`/api/commerce/options?skip=${e}&limit=${t}&commerce=${qe.commerceId}&store=${r}&warehouse=${n}`)}setOptionsQuantity(e,t,r,n,s){return this._http.post("/api/commerce/quantity",{option:e,product:t,store:n,warehouse:s,quantity:r})}static{this.\u0275fac=function(t){return new(t||i)(me(Ze))}}static{this.\u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function V(i,o=0){return Rt(i)?Number(i):arguments.length===2?o:0}function Rt(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}function nt(i){return i instanceof x?i.nativeElement:i}var bt=new v("cdk-dir-doc",{providedIn:"root",factory:xt});function xt(){return a(B)}var Ot=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function Tt(i){let o=i?.toLowerCase()||"";return o==="auto"&&typeof navigator<"u"&&navigator?.language?Ot.test(navigator.language)?"rtl":"ltr":o==="rtl"?"rtl":"ltr"}var ot=(()=>{class i{value="ltr";change=new Se;constructor(){let e=a(bt,{optional:!0});if(e){let t=e.body?e.body.dir:null,r=e.documentElement?e.documentElement.dir:null;this.value=Tt(t||r||"ltr")}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var K=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=C({type:i});static \u0275inj=g({})}return i})();var J=class{};function st(i){return i&&typeof i.connect=="function"&&!(i instanceof oe)}var j=class extends J{_data;constructor(o){super(),this._data=o}connect(){return A(this._data)?this._data:R(this._data)}disconnect(){}},F=function(i){return i[i.REPLACED=0]="REPLACED",i[i.INSERTED=1]="INSERTED",i[i.MOVED=2]="MOVED",i[i.REMOVED=3]="REMOVED",i}(F||{}),ee=new v("_ViewRepeater");var U=class{viewCacheSize=20;_viewCache=[];applyChanges(o,e,t,r,n){o.forEachOperation((s,c,l)=>{let d,M;if(s.previousIndex==null){let mt=()=>t(s,c,l);d=this._insertView(mt,l,e,r(s)),M=d?F.INSERTED:F.REPLACED}else l==null?(this._detachAndCacheView(c,e),M=F.REMOVED):(d=this._moveView(c,l,e,r(s)),M=F.MOVED);n&&n({context:d?.context,operation:M,record:s})})}detach(){for(let o of this._viewCache)o.destroy();this._viewCache=[]}_insertView(o,e,t,r){let n=this._insertViewFromCache(e,t);if(n){n.context.$implicit=r;return}let s=o();return t.createEmbeddedView(s.templateRef,s.context,s.index)}_detachAndCacheView(o,e){let t=e.detach(o);this._maybeCacheView(t,e)}_moveView(o,e,t,r){let n=t.get(o);return t.move(n,e),n.context.$implicit=r,n}_maybeCacheView(o,e){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(o);else{let t=e.indexOf(o);t===-1?o.destroy():e.remove(t)}}_insertViewFromCache(o,e){let t=this._viewCache.pop();return t&&e.insert(t,o),t||null}};var kt=["contentWrapper"],Vt=["*"],dt=new v("VIRTUAL_SCROLL_STRATEGY"),te=class{_scrolledIndexChange=new u;scrolledIndexChange=this._scrolledIndexChange.pipe(de());_viewport=null;_itemSize;_minBufferPx;_maxBufferPx;constructor(o,e,t){this._itemSize=o,this._minBufferPx=e,this._maxBufferPx=t}attach(o){this._viewport=o,this._updateTotalContentSize(),this._updateRenderedRange()}detach(){this._scrolledIndexChange.complete(),this._viewport=null}updateItemAndBufferSize(o,e,t){t<e,this._itemSize=o,this._minBufferPx=e,this._maxBufferPx=t,this._updateTotalContentSize(),this._updateRenderedRange()}onContentScrolled(){this._updateRenderedRange()}onDataLengthChanged(){this._updateTotalContentSize(),this._updateRenderedRange()}onContentRendered(){}onRenderedOffsetChanged(){}scrollToIndex(o,e){this._viewport&&this._viewport.scrollToOffset(o*this._itemSize,e)}_updateTotalContentSize(){this._viewport&&this._viewport.setTotalContentSize(this._viewport.getDataLength()*this._itemSize)}_updateRenderedRange(){if(!this._viewport)return;let o=this._viewport.getRenderedRange(),e={start:o.start,end:o.end},t=this._viewport.getViewportSize(),r=this._viewport.getDataLength(),n=this._viewport.measureScrollOffset(),s=this._itemSize>0?n/this._itemSize:0;if(e.end>r){let l=Math.ceil(t/this._itemSize),d=Math.max(0,Math.min(s,r-l));s!=d&&(s=d,n=d*this._itemSize,e.start=Math.floor(s)),e.end=Math.max(0,Math.min(r,e.start+l))}let c=n-e.start*this._itemSize;if(c<this._minBufferPx&&e.start!=0){let l=Math.ceil((this._maxBufferPx-c)/this._itemSize);e.start=Math.max(0,e.start-l),e.end=Math.min(r,Math.ceil(s+(t+this._minBufferPx)/this._itemSize))}else{let l=e.end*this._itemSize-(n+t);if(l<this._minBufferPx&&e.end!=r){let d=Math.ceil((this._maxBufferPx-l)/this._itemSize);d>0&&(e.end=Math.min(r,e.end+d),e.start=Math.max(0,Math.floor(s-this._minBufferPx/this._itemSize)))}}this._viewport.setRenderedRange(e),this._viewport.setRenderedContentOffset(this._itemSize*e.start),this._scrolledIndexChange.next(Math.floor(s))}};function Ft(i){return i._scrollStrategy}var ht=(()=>{class i{get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=V(e)}_itemSize=20;get minBufferPx(){return this._minBufferPx}set minBufferPx(e){this._minBufferPx=V(e)}_minBufferPx=100;get maxBufferPx(){return this._maxBufferPx}set maxBufferPx(e){this._maxBufferPx=V(e)}_maxBufferPx=200;_scrollStrategy=new te(this.itemSize,this.minBufferPx,this.maxBufferPx);ngOnChanges(){this._scrollStrategy.updateItemAndBufferSize(this.itemSize,this.minBufferPx,this.maxBufferPx)}static \u0275fac=function(t){return new(t||i)};static \u0275dir=w({type:i,selectors:[["cdk-virtual-scroll-viewport","itemSize",""]],inputs:{itemSize:"itemSize",minBufferPx:"minBufferPx",maxBufferPx:"maxBufferPx"},features:[k([{provide:dt,useFactory:Ft,deps:[_e(()=>i)]}]),Ce]})}return i})(),Mt=20,At=(()=>{class i{_ngZone=a(b);_platform=a(P);_renderer=a(G).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new u;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let t=this.scrollContainers.get(e);t&&(t.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=Mt){return this._platform.isBrowser?new W(t=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let r=e>0?this._scrolled.pipe(L(e)).subscribe(t):this._scrolled.subscribe(t);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):R()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,t)=>this.deregister(t)),this._scrolled.complete()}ancestorScrolled(e,t){let r=this.getAncestorScrollContainers(e);return this.scrolled(t).pipe(ce(n=>!n||r.indexOf(n)>-1))}getAncestorScrollContainers(e){let t=[];return this.scrollContainers.forEach((r,n)=>{this._scrollableContainsElement(n,e)&&t.push(n)}),t}_scrollableContainsElement(e,t){let r=nt(t),n=e.getElementRef().nativeElement;do if(r==n)return!0;while(r=r.parentElement);return!1}static \u0275fac=function(t){return new(t||i)};static \u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),ut=(()=>{class i{elementRef=a(x);scrollDispatcher=a(At);ngZone=a(b);dir=a(ot,{optional:!0});_scrollElement=this.elementRef.nativeElement;_destroyed=new u;_renderer=a(De);_cleanupScroll;_elementScrolled=new u;constructor(){}ngOnInit(){this._cleanupScroll=this.ngZone.runOutsideAngular(()=>this._renderer.listen(this._scrollElement,"scroll",e=>this._elementScrolled.next(e))),this.scrollDispatcher.register(this)}ngOnDestroy(){this._cleanupScroll?.(),this._elementScrolled.complete(),this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){let t=this.elementRef.nativeElement,r=this.dir&&this.dir.value=="rtl";e.left==null&&(e.left=r?e.end:e.start),e.right==null&&(e.right=r?e.start:e.end),e.bottom!=null&&(e.top=t.scrollHeight-t.clientHeight-e.bottom),r&&y()!=E.NORMAL?(e.left!=null&&(e.right=t.scrollWidth-t.clientWidth-e.left),y()==E.INVERTED?e.left=e.right:y()==E.NEGATED&&(e.left=e.right?-e.right:e.right)):e.right!=null&&(e.left=t.scrollWidth-t.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){let t=this.elementRef.nativeElement;Ye()?t.scrollTo(e):(e.top!=null&&(t.scrollTop=e.top),e.left!=null&&(t.scrollLeft=e.left))}measureScrollOffset(e){let t="left",r="right",n=this.elementRef.nativeElement;if(e=="top")return n.scrollTop;if(e=="bottom")return n.scrollHeight-n.clientHeight-n.scrollTop;let s=this.dir&&this.dir.value=="rtl";return e=="start"?e=s?r:t:e=="end"&&(e=s?t:r),s&&y()==E.INVERTED?e==t?n.scrollWidth-n.clientWidth-n.scrollLeft:n.scrollLeft:s&&y()==E.NEGATED?e==t?n.scrollLeft+n.scrollWidth-n.clientWidth:-n.scrollLeft:e==t?n.scrollLeft:n.scrollWidth-n.clientWidth-n.scrollLeft}static \u0275fac=function(t){return new(t||i)};static \u0275dir=w({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]})}return i})(),Lt=20,It=(()=>{class i{_platform=a(P);_listeners;_viewportSize;_change=new u;_document=a(B,{optional:!0});constructor(){let e=a(b),t=a(G).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let r=n=>this._change.next(n);this._listeners=[t.listen("window","resize",r),t.listen("window","orientationchange",r)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:t,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+t,height:r,width:t}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,t=this._getWindow(),r=e.documentElement,n=r.getBoundingClientRect(),s=-n.top||e.body.scrollTop||t.scrollY||r.scrollTop||0,c=-n.left||e.body.scrollLeft||t.scrollX||r.scrollLeft||0;return{top:s,left:c}}change(e=Lt){return e>0?this._change.pipe(L(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),lt=new v("VIRTUAL_SCROLLABLE"),zt=(()=>{class i extends ut{constructor(){super()}measureViewportSize(e){let t=this.elementRef.nativeElement;return e==="horizontal"?t.clientWidth:t.clientHeight}static \u0275fac=function(t){return new(t||i)};static \u0275dir=w({type:i,features:[Q]})}return i})();function Bt(i,o){return i.start==o.start&&i.end==o.end}var Pt=typeof requestAnimationFrame<"u"?le:se,ie=(()=>{class i extends zt{elementRef=a(x);_changeDetectorRef=a(Ne);_scrollStrategy=a(dt,{optional:!0});scrollable=a(lt,{optional:!0});_platform=a(P);_detachedSubject=new u;_renderedRangeSubject=new u;get orientation(){return this._orientation}set orientation(e){this._orientation!==e&&(this._orientation=e,this._calculateSpacerSize())}_orientation="vertical";appendOnly=!1;scrolledIndexChange=new W(e=>this._scrollStrategy.scrolledIndexChange.subscribe(t=>Promise.resolve().then(()=>this.ngZone.run(()=>e.next(t)))));_contentWrapper;renderedRangeStream=this._renderedRangeSubject;_totalContentSize=0;_totalContentWidth="";_totalContentHeight="";_renderedContentTransform;_renderedRange={start:0,end:0};_dataLength=0;_viewportSize=0;_forOf;_renderedContentOffset=0;_renderedContentOffsetNeedsRewrite=!1;_isChangeDetectionPending=!1;_runAfterChangeDetection=[];_viewportChanges=ne.EMPTY;_injector=a(we);_isDestroyed=!1;constructor(){super();let e=a(It);this._scrollStrategy,this._viewportChanges=e.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe($(null),L(0,Pt),I(this._destroyed)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),this._isDestroyed=!0,super.ngOnDestroy()}attach(e){this._forOf,this.ngZone.runOutsideAngular(()=>{this._forOf=e,this._forOf.dataStream.pipe(I(this._detachedSubject)).subscribe(t=>{let r=t.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(e){return this.getElementRef().nativeElement.getBoundingClientRect()[e]}setTotalContentSize(e){this._totalContentSize!==e&&(this._totalContentSize=e,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(e){Bt(this._renderedRange,e)||(this.appendOnly&&(e={start:0,end:Math.max(this._renderedRange.end,e.end)}),this._renderedRangeSubject.next(this._renderedRange=e),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(e,t="to-start"){e=this.appendOnly&&t==="to-start"?0:e;let r=this.dir&&this.dir.value=="rtl",n=this.orientation=="horizontal",s=n?"X":"Y",l=`translate${s}(${Number((n&&r?-1:1)*e)}px)`;this._renderedContentOffset=e,t==="to-end"&&(l+=` translate${s}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=l&&(this._renderedContentTransform=l,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(e,t="auto"){let r={behavior:t};this.orientation==="horizontal"?r.start=e:r.top=e,this.scrollable.scrollTo(r)}scrollToIndex(e,t="auto"){this._scrollStrategy.scrollToIndex(e,t)}measureScrollOffset(e){let t;return this.scrollable==this?t=r=>super.measureScrollOffset(r):t=r=>this.scrollable.measureScrollOffset(r),Math.max(0,t(e??(this.orientation==="horizontal"?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(e){let t,r="left",n="right",s=this.dir?.value=="rtl";e=="start"?t=s?n:r:e=="end"?t=s?r:n:e?t=e:t=this.orientation==="horizontal"?"left":"top";let c=this.scrollable.measureBoundingClientRectWithScrollOffset(t);return this.elementRef.nativeElement.getBoundingClientRect()[t]-c}measureRenderedContentSize(){let e=this._contentWrapper.nativeElement;return this.orientation==="horizontal"?e.offsetWidth:e.offsetHeight}measureRangeSize(e){return this._forOf?this._forOf.measureRangeSize(e,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(e){e&&this._runAfterChangeDetection.push(e),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isDestroyed||this.ngZone.run(()=>{this._changeDetectorRef.markForCheck(),this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,Ee(()=>{this._isChangeDetectionPending=!1;let e=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(let t of e)t()},{injector:this._injector})})}_calculateSpacerSize(){this._totalContentHeight=this.orientation==="horizontal"?"":`${this._totalContentSize}px`,this._totalContentWidth=this.orientation==="horizontal"?`${this._totalContentSize}px`:""}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=z({type:i,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,r){if(t&1&&Fe(kt,7),t&2){let n;Me(n=Ae())&&(r._contentWrapper=n.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,r){t&2&&xe("cdk-virtual-scroll-orientation-horizontal",r.orientation==="horizontal")("cdk-virtual-scroll-orientation-vertical",r.orientation!=="horizontal")},inputs:{orientation:"orientation",appendOnly:[2,"appendOnly","appendOnly",Ue]},outputs:{scrolledIndexChange:"scrolledIndexChange"},features:[k([{provide:ut,useFactory:(e,t)=>e||t,deps:[[new ve,new ge(lt)],i]}]),Q],ngContentSelectors:Vt,decls:4,vars:4,consts:[["contentWrapper",""],[1,"cdk-virtual-scroll-content-wrapper"],[1,"cdk-virtual-scroll-spacer"]],template:function(t,r){t&1&&(ke(),f(0,"div",1,0),Ve(2),p(),Oe(3,"div",2)),t&2&&(_(3),be("width",r._totalContentWidth)("height",r._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0})}return i})();function at(i,o,e){let t=e;if(!t.getBoundingClientRect)return 0;let r=t.getBoundingClientRect();return i==="horizontal"?o==="start"?r.left:r.right:o==="start"?r.top:r.bottom}var ft=(()=>{class i{_viewContainerRef=a(Re);_template=a(ye);_differs=a(je);_viewRepeater=a(ee);_viewport=a(ie,{skipSelf:!0});viewChange=new u;_dataSourceChanges=new u;get cdkVirtualForOf(){return this._cdkVirtualForOf}set cdkVirtualForOf(e){this._cdkVirtualForOf=e,st(e)?this._dataSourceChanges.next(e):this._dataSourceChanges.next(new j(A(e)?e:Array.from(e||[])))}_cdkVirtualForOf;get cdkVirtualForTrackBy(){return this._cdkVirtualForTrackBy}set cdkVirtualForTrackBy(e){this._needsUpdate=!0,this._cdkVirtualForTrackBy=e?(t,r)=>e(t+(this._renderedRange?this._renderedRange.start:0),r):void 0}_cdkVirtualForTrackBy;set cdkVirtualForTemplate(e){e&&(this._needsUpdate=!0,this._template=e)}get cdkVirtualForTemplateCacheSize(){return this._viewRepeater.viewCacheSize}set cdkVirtualForTemplateCacheSize(e){this._viewRepeater.viewCacheSize=V(e)}dataStream=this._dataSourceChanges.pipe($(null),he(),fe(([e,t])=>this._changeDataSource(e,t)),ue(1));_differ=null;_data;_renderedItems;_renderedRange;_needsUpdate=!1;_destroyed=new u;constructor(){let e=a(b);this.dataStream.subscribe(t=>{this._data=t,this._onRenderedDataChange()}),this._viewport.renderedRangeStream.pipe(I(this._destroyed)).subscribe(t=>{this._renderedRange=t,this.viewChange.observers.length&&e.run(()=>this.viewChange.next(this._renderedRange)),this._onRenderedDataChange()}),this._viewport.attach(this)}measureRangeSize(e,t){if(e.start>=e.end)return 0;e.start<this._renderedRange.start||e.end>this._renderedRange.end;let r=e.start-this._renderedRange.start,n=e.end-e.start,s,c;for(let l=0;l<n;l++){let d=this._viewContainerRef.get(l+r);if(d&&d.rootNodes.length){s=c=d.rootNodes[0];break}}for(let l=n-1;l>-1;l--){let d=this._viewContainerRef.get(l+r);if(d&&d.rootNodes.length){c=d.rootNodes[d.rootNodes.length-1];break}}return s&&c?at(t,"end",c)-at(t,"start",s):0}ngDoCheck(){if(this._differ&&this._needsUpdate){let e=this._differ.diff(this._renderedItems);e?this._applyChanges(e):this._updateContext(),this._needsUpdate=!1}}ngOnDestroy(){this._viewport.detach(),this._dataSourceChanges.next(void 0),this._dataSourceChanges.complete(),this.viewChange.complete(),this._destroyed.next(),this._destroyed.complete(),this._viewRepeater.detach()}_onRenderedDataChange(){this._renderedRange&&(this._renderedItems=this._data.slice(this._renderedRange.start,this._renderedRange.end),this._differ||(this._differ=this._differs.find(this._renderedItems).create((e,t)=>this.cdkVirtualForTrackBy?this.cdkVirtualForTrackBy(e,t):t)),this._needsUpdate=!0)}_changeDataSource(e,t){return e&&e.disconnect(this),this._needsUpdate=!0,t?t.connect(this):R()}_updateContext(){let e=this._data.length,t=this._viewContainerRef.length;for(;t--;){let r=this._viewContainerRef.get(t);r.context.index=this._renderedRange.start+t,r.context.count=e,this._updateComputedContextProperties(r.context),r.detectChanges()}}_applyChanges(e){this._viewRepeater.applyChanges(e,this._viewContainerRef,(n,s,c)=>this._getEmbeddedViewArgs(n,c),n=>n.item),e.forEachIdentityChange(n=>{let s=this._viewContainerRef.get(n.currentIndex);s.context.$implicit=n.item});let t=this._data.length,r=this._viewContainerRef.length;for(;r--;){let n=this._viewContainerRef.get(r);n.context.index=this._renderedRange.start+r,n.context.count=t,this._updateComputedContextProperties(n.context)}}_updateComputedContextProperties(e){e.first=e.index===0,e.last=e.index===e.count-1,e.even=e.index%2===0,e.odd=!e.even}_getEmbeddedViewArgs(e,t){return{templateRef:this._template,context:{$implicit:e.item,cdkVirtualForOf:this._cdkVirtualForOf,index:-1,count:-1,first:!1,last:!1,odd:!1,even:!1},index:t}}static ngTemplateContextGuard(e,t){return!0}static \u0275fac=function(t){return new(t||i)};static \u0275dir=w({type:i,selectors:[["","cdkVirtualFor","","cdkVirtualForOf",""]],inputs:{cdkVirtualForOf:"cdkVirtualForOf",cdkVirtualForTrackBy:"cdkVirtualForTrackBy",cdkVirtualForTemplate:"cdkVirtualForTemplate",cdkVirtualForTemplateCacheSize:"cdkVirtualForTemplateCacheSize"},features:[k([{provide:ee,useClass:U}])]})}return i})();var ct=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=C({type:i});static \u0275inj=g({})}return i})(),pt=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=C({type:i});static \u0275inj=g({imports:[K,ct,K,ct]})}return i})();function jt(i,o){if(i&1&&(f(0,"span"),T(1),p()),i&2){let e=X().$implicit;_(),Le(e.product.name)}}function Ut(i,o){if(i&1){let e=Te();f(0,"div",5)(1,"span"),Z(2,jt,2,1,"span",6),T(3),p(),f(4,"winput",7),Pe("ngModelChange",function(r){let n=H(e).$implicit;return Be(n.quantity,r)||(n.quantity=r),q(r)}),S("change",function(){let r=H(e).$implicit,n=X();return q(n.onQuantityChange(r))}),p()()}if(i&2){let e=o.$implicit;_(2),Y("ngIf",e.product),_(),Ie(" - ",e.name,""),_(),ze("ngModel",e.quantity)}}var re=(()=>{class i{constructor(e,t,r,n){this._commerceoptionService=e,this._route=t,this._ws=r,this._ss=n,this.store="",this.warehouse="",this.options=[],this.skip=0,this.limit=100,this.loading=!1,this._route.paramMap.subscribe(s=>{s.get("store_id")?this.store=s.get("store_id"):s.get("warehouse_id")&&(this.warehouse=s.get("warehouse_id"))})}ngOnInit(){this.loadOptions()}loadOptions(){this.loading||(this.loading=!0,this._commerceoptionService.getOptions(this.skip,this.limit,this.store,this.warehouse).pipe(pe(()=>this.loading=!1),ae(e=>{this.options=[...this.options,...e],this.skip+=this.limit})).subscribe())}export(){this.loading=!0,this._commerceoptionService.getOptions(0,0,this.store,this.warehouse).subscribe(e=>{this.loading=!1,this.exportToCSV(e)})}import(){}onFileChange(e){let t=e.target.files[0];if(t&&t.type==="text/csv"){let r=new FileReader;r.onload=()=>{let n=r.result.split(`
`);n.splice(0,3);let s=n.map(c=>{let l=c.split(",");return{product:l[0].replace(/^"|"$/g,""),quantity:Number(l[1]),warehouse:(l[2]||"").replace(/^"|"$/g,"").trim(),store:(l[3]||"").replace(/^"|"$/g,"").trim(),option:(l[4]||"").replace(/^"|"$/g,""),_id:(l[5]||"").replace(/^"|"|\r$/g,"")}});console.log(s.slice(0,5))},r.readAsText(t)}else alert("Please upload a valid CSV file.")}onQuantityChange(e){this._commerceoptionService.setOptionsQuantity(e._id,e.product._id,e.quantity,this.store,this.warehouse).subscribe()}onScroll(e){e+this.limit/2>=this.options.length&&this.loadOptions()}exportToCSV(e){if(!e||e.length===0){alert("\u041D\u0435\u043C\u0430\u0454 \u0434\u0430\u043D\u0438\u0445 \u0434\u043B\u044F \u0435\u043A\u0441\u043F\u043E\u0440\u0442\u0443.");return}let t={fieldSeparator:",",quoteStrings:'"',decimalSeparator:".",showLabels:!0,showTitle:!0,title:`\u0421\u043F\u0438\u0441\u043E\u043A \u0442\u043E\u0432\u0430\u0440\u0456\u0432 - ${new Date().toLocaleString()}`,useTextFile:!1,useBom:!0,headers:["\u041D\u0430\u0437\u0432\u0430 \u043F\u0440\u043E\u0434\u0443\u043A\u0442\u0443","\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C","\u0421\u043A\u043B\u0430\u0434","\u041C\u0430\u0433\u0430\u0437\u0438\u043D","ID Options","ID"]},r=e.map(n=>({"\u041D\u0430\u0437\u0432\u0430 \u043F\u0440\u043E\u0434\u0443\u043A\u0442\u0443":n.product.name,\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C:n.quantity,\u0421\u043A\u043B\u0430\u0434:this._ws.commercewarehouses.find(s=>s._id===this.warehouse)?.url||"",\u041C\u0430\u0433\u0430\u0437\u0438\u043D:this._ss.commercestores.find(s=>s._id===this.store)?.url||"","ID Options":n._id,ID:n.product._id}));new _t.ngxCsv(r,"Commerce_Options_Full",t)}static{this.\u0275fac=function(t){return new(t||i)(O(rt),O($e),O(et),O(tt))}}static{this.\u0275cmp=z({type:i,selectors:[["ng-component"]],standalone:!1,decls:8,vars:1,consts:[["for","importcsv",3,"click"],["id","importcsv","type","file","accept",".csv",3,"change"],[3,"click"],["itemSize","50",1,"scroll-container",3,"scrolledIndexChange"],["class","item",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"item"],[4,"ngIf"],["type","number",1,"quantity-input",3,"ngModelChange","change","ngModel"]],template:function(t,r){t&1&&(f(0,"label",0),S("click",function(s){return s.stopPropagation()}),f(1,"wbutton"),T(2,"\u0406\u043C\u043F\u043E\u0440\u0442\u0443\u0432\u0430\u0442\u0438"),p(),f(3,"input",1),S("change",function(s){return r.onFileChange(s)}),p()(),f(4,"wbutton",2),S("click",function(){return r.export()}),T(5,"\u0415\u043A\u0441\u043F\u043E\u0440\u0442\u0443\u0432\u0430\u0442\u0438"),p(),f(6,"cdk-virtual-scroll-viewport",3),S("scrolledIndexChange",function(s){return r.onScroll(s)}),Z(7,Ut,5,3,"div",4),p()),t&2&&(_(7),Y("cdkVirtualForOf",r.options))},dependencies:[We,Ge,Qe,Xe,Ke,ht,ft,ie],styles:[".scroll-container[_ngcontent-%COMP%]{height:400px;width:100%;overflow:auto;border:1px solid #ccc}.item[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #ddd}"]})}}return i})();var Wt=[{path:"store/:store_id",component:re},{path:"warehouse/:warehouse_id",component:re}],Bi=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=C({type:i})}static{this.\u0275inj=g({imports:[He.forChild(Wt),Je,pt]})}}return i})();export{Bi as CommerceoptionsModule};
